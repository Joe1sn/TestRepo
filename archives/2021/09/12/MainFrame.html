<!DOCTYPE html>
<html><head>
<meta charset="UTF-8" /><title>PureWeb Blog-CTF Re 入门大纲</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css" /><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>  <script>    document.querySelectorAll('code').forEach((code) => {      if (!code.classList.length) {        code.classList.add('language-bash');      }    });  </script>	<script>		document.addEventListener('DOMContentLoaded', (event) => {			hljs.highlightAll();		});	</script><link rel="stylesheet" href="/TestRepo/github.css">
<link rel="stylesheet" href="/TestRepo/speciou.css"
</head><body><div class="container"><header class="main-header"><h1 class="main-header__title uplize"><a class="main-header__title__link" href="/TestRepo">PureWeb Blog</a></h1><nav class="main-header__nav"><ul class="main-nav"><li class="main-nav__list"><a class="main-nav__list__link active" href="/TestRepo" target="_self">HOME</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/TestRepoarchives/"target="_self">ARCHIVE</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="https://github.com/Joe1sn"target="_blank">GITHUB</a></li></ul></nav></header></div><div id="write" class>
<div id="write" class>
<div class="typora-export os-windows"><div id="write" class>
<p><strong>2021-9-12 22:59</strong></p>
<p>逆向相关工具</p>
<!-- more -->
<h1>工具</h1>
<h2>反汇编</h2>
<h3>万能</h3>
<ul>
<li><strong>ghidra</strong>：美国NSA出品，能搞定plt混乱等，很牛皮</li>
</ul>
<h3>IDA相关</h3>
<ul>
<li><strong>ida_6.8</strong> ：适合32位系统(windowsXP)</li>
<li><strong>ida_7.0</strong>：主流</li>
<li><strong>ida_7.5</strong>：最新版，增加一些过混淆，异构程序F5</li>
</ul>
<p><strong>IDA其他常用的一些插件</strong></p>
<p><strong><a href="https://github.com/veritas501/PltResolver">PLTResolver</a></strong> - 恢复被打乱的PLT，方便逆向
<strong>IDA FLIRT Signature Database</strong> – 用于识别静态编译的可执行文件中的库函数
<strong>Find Crypt</strong> – 寻找常用加密算法中的常数（需要安装 yara-python）
<strong>IDA signsrch</strong> – 寻找二进制文件所使用的加密、压缩算法
<strong>Ponce</strong> – 污点分析和符号化执行工具
<strong>snowman decompiler</strong> – C/C++反汇编插件（F3 进行反汇编）
<strong>CodeXplorer</strong> – 自动类型重建以及对象浏览（C++）（jump to disasm)
<strong>IDA Ref</strong> – 汇编指令注释（支持arm，x86，mips）
<strong>auto re</strong> – 函数自动重命名
<strong>nao – dead code</strong> 清除HexRaysPyTools – 类/结构体创建和虚函数表检测
<strong>DIE</strong> – 动态调试增强工具，保存函数调用上下文信息
<strong>sk3wldbg</strong> – IDA 动态调试器，支持多平台
<strong>idaemu</strong> – 模拟代码执行（支持X86、ARM平台）
<strong>Diaphora</strong> – 程序差异比较
<strong>Keypatch</strong> – 基于 Keystone 的 Patch 二进制文件插件
<strong>FRIEND</strong> – 哪里不会点哪里，提升汇编格式的可读性、提供指令、寄存器的文档等
<strong>SimplifyGraph</strong> – 简化复杂的函数流程图
<strong>bincat</strong> – 静态二进制代码分析工具包，2017 Hex-Rays 插件第一名
<strong>golang_loader_assist</strong> – Golang编译的二进制文件分析助手</p>
<h3>安卓反汇编</h3>
<ul>
<li><strong>jadx-gui</strong>：安卓逆向静态审计</li>
<li><strong>apktoolbox</strong>：smail反编译与编译，方便修改代码</li>
</ul>
<h2>动态调试</h2>
<h3>windows</h3>
<ul>
<li>
<p><strong>Olldbg</strong>：经典，插件多，但是只能调试32位</p>
</li>
<li>
<p><strong>x32/x64dbg</strong>：和od差不多，但是能调试的64位，插件较少</p>
</li>
<li>
<p><strong>windbg</strong>：windows内核调试</p>
</li>
<li>
<p><strong>CheatEngine</strong>：常见于游戏逆向</p>
</li>
</ul>
<h3>Linux</h3>
<ul>
<li><strong>gdb</strong>：yyds
<ul>
<li>gdb各种插件</li>
</ul>
</li>
</ul>
<h3>Android</h3>
<ul>
<li><strong>android_killer</strong>：经典apk动调工具</li>
<li><strong>android_studio</strong>：开发调试</li>
</ul>
<h3>Others</h3>
<ul>
<li>qemu或者docker挂上ida_server调</li>
</ul>
<h2>查壳</h2>
<h3>Windows</h3>
<ul>
<li><strong>PEID</strong></li>
<li><strong>EXEINFO</strong></li>
</ul>
<h3>Linux</h3>
<ul>
<li>checksec（详细参考pwn中pwntools安装）</li>
</ul>
<h2>脱壳</h2>
<ul>
<li>
<p>unpack -&gt; execute</p>
<p>直接将程序代码全部解压到内存中再继续执行程序代码</p>
</li>
<li>
<p>unpack -&gt; execute -&gt; unpack -&gt; execute ...</p>
<p>解压部分代码，再边解压边执行</p>
</li>
<li>
<p>unpack -&gt; [decoder | encoded code] -&gt; decode -&gt; execute</p>
<p>程序代码有过编码，<strong>在解压后再运行函数将真正的程序代码解码执</strong></p>
</li>
<li>
<p><strong>UPX</strong></p>
<ul>
<li>压缩壳，巨简单</li>
<li>Linux：<code>apt install upx</code> 在使用 <code>upx -d filename</code>直接脱壳</li>
<li>windows：官网的upx.exe，用法同上</li>
</ul>
</li>
</ul>
<p>下面两个壳一般会手动脱</p>
<ul>
<li><strong>PECompat</strong></li>
<li><strong>ASpack</strong></li>
</ul>
<h1>常见算法识别</h1>
<p>**IDA：**FindCrypt <a href="https://blog.csdn.net/userpass_word/article/details/80484467">IDA 7.0版本安装查询加密算法的findcrypt3脚本插件的详细步骤</a></p>
<p>**PEID：**KANAL（Krypto ANALyzer） (PEiD自带)</p>
<h2>特征值识别</h2>
<p><img src="https://z3.ax1x.com/2021/05/06/glmOhQ.png" alt="特征值识别" /></p>
<h2>特征算法识别</h2>
<p><img src="https://z3.ax1x.com/2021/05/06/glmLtg.png" alt="特征值识别" /></p>
<h2>第三方库识别</h2>
<ul>
<li>
<p><strong>字符串报错</strong></p>
</li>
<li>
<p><strong>函数签名识别</strong></p>
<p>Load File -&gt; Flirter file</p>
</li>
<li>
<p><strong>Diff二进制对比识别</strong></p>
</li>
</ul>
<h1>现代逆向工程</h1>
<h2>符号执行</h2>
<p><strong>必要工具</strong></p>
<ul>
<li>
<p><strong>python虚拟机</strong>：python的库之间会起冲突，比如angr会修改z3，那么需要一个python的虚拟环境</p>
</li>
<li>
<p><strong>z3</strong>：2020 CISCN出现过，也是一个泛型约束求解的东西</p>
</li>
<li>
<p><strong>angr</strong>：强大的模拟执行工具，有些z3不能解的这个可以解</p>
</li>
<li>
<p><strong>去平坦化（OLLVM）</strong>：编译原理相关，可以试试用脚本还原 （<a href="https://security.tencent.com/index.php/blog/msg/112">利用符号执行去除控制流平坦化</a>）</p>
</li>
</ul>
<h2>Pin插桩</h2>
<p>貌似国赛都没考过，但是可以方便分析，主要涉及一些工具和hook编程</p>
<h2>混淆和保护</h2>
<p>一般就是花指令，反调试等</p>
<p><a href="https://www.anquanke.com/post/id/236490">花指令总结</a></p>
<p>有些脚本可能会临时找</p>
<h3>WebAssembly</h3>
<p><a href="https://www.wasm.com.cn/">wasm官网</a></p>
<p><a href="https://www.anquanke.com/post/id/179556">一步步学习Webassembly逆向分析方法</a></p>
<h1>反调试</h1>
<p>详见：windows反调试笔记.md（API）、 CTFer成长之路-Nu1L战队/从0到1 、CTFWiki</p>
<h2>Windows</h2>
<p>主要利用的是 API 断点检测 其他技巧</p>
<h2>Linux</h2>
<p>ptrace开启两个进程（MRCTF2021有涉及）</p>
<h1>游戏逆向</h1>
<p>一般是Unity游戏的逆向，Unity又是基于C#编写，所以静态分析会使用类似<strong>Dnspy</strong>等工具</p>
<p>修改内存的话是<strong>CheateEngine</strong>，还是比较主流的修改器制作</p>
<h1>高级语言逆向</h1>
<p>一般有：<strong>python Golang Rust</strong></p>
<ul>
<li><strong>python</strong>：pyc逆向，python字节码逆向，python-installer逆向</li>
<li>**Golang **：IDAGolangHelper
<ul>
<li><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.anquanke.com%2Fpost%2Fid%2F170332">无符号Golang程序逆向方法解析 </a></li>
<li><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fstudygolang.com%2Farticles%2F6926">golang base64加密与解密 </a></li>
<li><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fblog.csdn.net%2Fxiangshangbashaonian%2Farticle%2Fdetails%2F83146678">MIPS架构的CTF逆向题--SUCTFbabyre题目writeup </a></li>
</ul>
</li>
</ul>
<p>详见 CTFer成长之路-Nu1L战队/从0到1</p>
<h1>DUMP内存</h1>
<p>万能的脱壳方法，加壳的程序在运行时肯定是自身脱壳的，所以内存的程序是已经脱了壳的</p>
<ul>
<li>火绒剑 PC_Hunter windows任务管理器</li>
</ul>
<p>详见 CTFer成长之路-Nu1L战队/从0到1</p>
<h1>教程总结</h1>
<p><a href="http://www.52bug.cn/hacktool/2992.html">Hacking Tools搜罗大集合</a>、</p>
<p><a href="https://blog.csdn.net/userpass_word/article/details/80484467">IDA 7.0版本安装查询加密算法的findcrypt3脚本插件的详细步骤</a></p>
<p><a href="https://security.tencent.com/index.php/blog/msg/112">利用符号执行去除控制流平坦化</a></p>
<p><a href="https://github.com/sibears/IDAGolangHelper">IDAGolangHelper</a></p>
<p><a href="https://github.com/nihilus/IDA_Signsrch">IDA_Signsrch</a></p>
<p><a href="https://www.52pojie.cn/thread-1128884-1-1.html">frida入门总结</a></p>
<p><a href="https://www.wasm.com.cn/">wasm官网</a></p>
<p><a href="https://www.anquanke.com/post/id/179556">一步步学习Webassembly逆向分析方法</a></p>

</div>
</div></body>